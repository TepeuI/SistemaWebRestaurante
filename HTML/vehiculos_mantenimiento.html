<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehículos y Mantenimiento</title>
    <!-- Google Fonts: Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body, h1, h2, h3, h4, h5, h6, label, input, button, table, th, td {
            font-family: 'Poppins', Arial, Helvetica, sans-serif !important;
        }
    </style>
    <!-- Frameworks y librerías base -->
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.min.css">
    <link rel="stylesheet" href="../css/boxicons.min.css">
    <link rel="stylesheet" href="../css/swiper-bundle.min.css">
    <link rel="stylesheet" href="../css/glightbox.min.css">
    <!-- Estilos personalizados globales -->
    <link rel="stylesheet" href="../css/diseñoModulos.css">
    <!-- Estilos específicos del sistema de inventario -->
</head>
<body>
    <header class="mb-4">
        <div class="container d-flex flex-column flex-md-row align-items-center justify-content-between py-3">
            <h1 class="mb-0">VEHÍCULOS - MANTENIMIENTO</h1>
            
                <ul class="nav nav-pills gap-2 mb-0">
                    <li class="nav-item"><a href="login.html" class="nav-link">Regresar</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container my-4">
        <section class="card shadow p-4">
            <h2 class="card__title text-primary mb-4">FORMULARIO PARA VEHÍCULOS Y MANTENIMIENTO</h2>

            <h2 class="card__title mb-3">Vehículos</h2>
            <form id="form-vehiculo" class="row g-3">
                <div class="col-md-3">
                    <label class="form-label" for="vehiculo-id">ID Vehículo:</label>
                    <input type="number" class="form-control" id="vehiculo-id" required placeholder="Ej. 1">
                </div>
                <div class="col-md-3">
                    <label class="form-label" for="vehiculo-mobiliario">ID Mobiliario:</label>
                    <input type="number" class="form-control" id="vehiculo-mobiliario" placeholder="Ej. 1">
                </div>
                <div class="col-md-3">
                    <label class="form-label" for="vehiculo-tipo">Tipo de Vehículo:</label>
                    <input type="text" class="form-control" id="vehiculo-tipo" required placeholder="Ej. Camión">
                </div>
                <div class="col-md-3">
                    <label class="form-label" for="vehiculo-placas">No. Placas:</label>
                    <input type="text" class="form-control" id="vehiculo-placas" required placeholder="Ej. ABC-123">
                </div>
                <!-- botones unificados en la parte inferior de la sección -->
            </form>
            <div class="table-responsive mt-3">
                <table class="table table-striped table-bordered" id="tabla-vehiculo">
                    <thead class="table-dark">
                        <tr>
                            <th>ID Vehículo</th>
                            <th>ID Mobiliario</th>
                            <th>Tipo de Vehículo</th>
                            <th>No. Placas</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>1</td>
                            <td>Camión</td>
                            <td>ABC-123</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        <section class="card shadow mb-4 p-4">
            <h2 class="card__title mb-3">Taller</h2>
            <form id="form-taller" class="row g-3">
                <div class="col-md-3">
                    <label class="form-label" for="taller-id">ID Taller:</label>
                    <input type="number" class="form-control" id="taller-id" required placeholder="Ej. 1">
                </div>
                <div class="col-md-3">
                    <label class="form-label" for="taller-nombre">Nombre Taller:</label>
                    <input type="text" class="form-control" id="taller-nombre" required placeholder="Ej. Taller Los tres hermanos">
                </div>
                <div class="col-md-3">
                    <label class="form-label" for="taller-descripcion">Descripción:</label>
                    <input type="text" class="form-control" id="taller-descripcion" placeholder="Ej.........">
                </div>
                <div class="col-md-3">
                    <label class="form-label" for="taller-telefono">Teléfono:</label>
                    <input type="text" class="form-control" id="taller-telefono" placeholder="Ej. 555-0123">
                </div>
                <div class="col-md-6">
                    <label class="form-label" for="taller-correo">Correo:</label>
                    <input type="email" class="form-control" id="taller-correo" placeholder="Ej. taller3hermanos@gmail.com">
                </div>
                <div class="col-12 d-flex gap-2 mt-3">
                    <!-- botones ahora centralizados en toolbar -->
                </div>
            </form>
            <div class="table-responsive mt-3">
                <table class="table table-striped table-bordered" id="tabla-taller">
                    <thead class="table-dark">
                        <tr>
                            <th>ID Taller</th>
                            <th>Nombre Taller</th>
                            <th>Descripción</th>
                            <th>Teléfono</th>
                            <th>Correo</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Taller MR</td>
                            <td>Mantenimiento general</td>
                            <td>555-0123</td>
                            <td>taller3hermanos@gmail.com</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="card shadow mb-4 p-4">

            <div class="row mt-4">
                <div class="col-12">
                    <h4 class="text-dark">Mantenimiento de Vehículos</h4>
                    <form id="form-mant-vehiculos" class="row g-3">
                        <div class="col-md-2">
                            <label class="form-label" for="mant-veh-id">ID Mantenimiento:</label>
                            <input type="number" class="form-control" id="mant-veh-id" required placeholder="Ej. 1">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label" for="mant-veh-desc">Descripción Mantenimiento:</label>
                            <input type="text" class="form-control" id="mant-veh-desc" required placeholder="Ej. Cambio de aceite">
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" for="mant-veh-fecha">Fecha Mantenimiento:</label>
                            <input type="date" class="form-control" id="mant-veh-fecha" required>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" for="mant-veh-taller">ID Taller:</label>
                            <input type="number" class="form-control" id="mant-veh-taller" required placeholder="Ej. 1">
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" for="mant-veh-costo">Costo Mantenimiento:</label>
                            <input type="number" step="0.01" class="form-control" id="mant-veh-costo" required placeholder="Ej. 500.00">
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" for="mant-veh-vehiculo">ID Vehículo:</label>
                            <input type="number" class="form-control" id="mant-veh-vehiculo" required placeholder="Ej. 1">
                        </div>
                    </form>
                    </form>
                    <div class="table-responsive mt-3">
                        <table class="table table-striped table-bordered" id="tabla-mant-vehiculos">
                            <thead class="table-dark">
                                <tr>
                                    <th>ID Mantenimiento</th>
                                    <th>Descripción</th>
                                    <th>Fecha</th>
                                    <th>ID Taller</th>
                                    <th>Costo</th>
                                    <th>ID Vehículo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Cambio de aceite</td>
                                    <td>2025-09-25</td>
                                    <td>1</td>
                                    <td>Q500.00</td>
                                    <td>1</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- toolbar unificado para acciones (actúa sobre la tabla activa) -->
            <div class="d-flex gap-2 mt-4">
                <button id="btn-nuevo" type="button" class="btn btn-danger">Nuevo</button>
                <button id="btn-guardar" type="button" class="btn btn-success">Guardar</button>
                <button id="btn-actualizar" type="button" class="btn btn-warning">Actualizar</button>
                <button id="btn-eliminar" type="button" class="btn btn-secondary">Eliminar</button>
                <div class="ms-auto text-muted align-self-center">Tabla activa: <span id="tabla-activa">vehículos</span></div>
            </div>

        </section>
    </main>
</body>
    <script>
        // Script para toolbar unificado: selecciona tabla activa y realiza CRUD básico en DOM
        (function(){
            const tablaVeh = document.getElementById('tabla-vehiculo');
            const tablaMant = document.getElementById('tabla-mant-vehiculos');
            const tablaTaller = document.getElementById('tabla-taller');
            const spanActiva = document.getElementById('tabla-activa');
            const btnNuevo = document.getElementById('btn-nuevo');
            const btnGuardar = document.getElementById('btn-guardar');
            const btnActualizar = document.getElementById('btn-actualizar');
            const btnEliminar = document.getElementById('btn-eliminar');

            let tablaActiva = 'vehiculos'; // 'vehiculos' o 'mantenimiento'
            let filaSeleccionada = null;

            function setActiva(name){
                tablaActiva = name;
                spanActiva.textContent = name;
                filaSeleccionada = null;
                // quitar clase selected de todas las filas
                [tablaVeh, tablaMant, tablaTaller].forEach(t => {
                    if(!t) return;
                    Array.from(t.querySelectorAll('tbody tr')).forEach(r => r.classList.remove('table-primary'));
                });
            }

            // elegir tabla activa al hacer click en una fila
            function attachRowClicks(tabla, name){
                tabla.addEventListener('click', function(e){
                    const tr = e.target.closest('tr');
                    if(!tr) return;
                    setActiva(name);
                    filaSeleccionada = tr;
                    // marcar visualmente
                    Array.from(tabla.querySelectorAll('tbody tr')).forEach(r => r.classList.remove('table-primary'));
                    tr.classList.add('table-primary');
                });
            }

            attachRowClicks(tablaVeh, 'vehículos');
            attachRowClicks(tablaMant, 'mantenimiento');
            if(tablaTaller) attachRowClicks(tablaTaller, 'taller');

            function limpiarForm(){
                // limpiar ambos formularios
                document.getElementById('form-vehiculo').reset();
                const fm = document.getElementById('form-mant-vehiculos');
                if(fm) fm.reset();
                const ft = document.getElementById('form-taller');
                if(ft) ft.reset();
            }

            btnNuevo.addEventListener('click', ()=>{ limpiarForm(); filaSeleccionada = null; });

            btnGuardar.addEventListener('click', ()=>{
                     if(tablaActiva === 'vehículos'){
                    const id = document.getElementById('vehiculo-id').value;
                    const mob = document.getElementById('vehiculo-mobiliario').value;
                    const tipo = document.getElementById('vehiculo-tipo').value;
                    const placas = document.getElementById('vehiculo-placas').value;
                    const tbody = tablaVeh.querySelector('tbody');
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td>${id}</td><td>${mob}</td><td>${tipo}</td><td>${placas}</td>`;
                    tbody.appendChild(tr);
                     } else if(tablaActiva === 'mantenimiento'){
                    const id = document.getElementById('mant-veh-id').value;
                    const desc = document.getElementById('mant-veh-desc').value;
                    const fecha = document.getElementById('mant-veh-fecha').value;
                    const taller = document.getElementById('mant-veh-taller').value;
                    const costo = document.getElementById('mant-veh-costo').value;
                    const veh = document.getElementById('mant-veh-vehiculo').value;
                    const tbody = tablaMant.querySelector('tbody');
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td>${id}</td><td>${desc}</td><td>${fecha}</td><td>${taller}</td><td>${costo}</td><td>${veh}</td>`;
                    tbody.appendChild(tr);
                     } else if(tablaActiva === 'taller'){
                          const id = document.getElementById('taller-id').value;
                          const nombre = document.getElementById('taller-nombre').value;
                          const desc = document.getElementById('taller-descripcion').value;
                          const tel = document.getElementById('taller-telefono').value;
                          const correo = document.getElementById('taller-correo').value;
                          const tbody = tablaTaller.querySelector('tbody');
                          const tr = document.createElement('tr');
                          tr.innerHTML = `<td>${id}</td><td>${nombre}</td><td>${desc}</td><td>${tel}</td><td>${correo}</td>`;
                          tbody.appendChild(tr);
                }
                limpiarForm();
            });

            btnActualizar.addEventListener('click', ()=>{
                if(!filaSeleccionada) return alert('Selecciona primero una fila de la tabla activa');
                if(tablaActiva === 'vehículos'){
                    filaSeleccionada.cells[0].textContent = document.getElementById('vehiculo-id').value;
                    filaSeleccionada.cells[1].textContent = document.getElementById('vehiculo-mobiliario').value;
                    filaSeleccionada.cells[2].textContent = document.getElementById('vehiculo-tipo').value;
                    filaSeleccionada.cells[3].textContent = document.getElementById('vehiculo-placas').value;
                } else if(tablaActiva === 'mantenimiento'){
                    filaSeleccionada.cells[0].textContent = document.getElementById('mant-veh-id').value;
                    filaSeleccionada.cells[1].textContent = document.getElementById('mant-veh-desc').value;
                    filaSeleccionada.cells[2].textContent = document.getElementById('mant-veh-fecha').value;
                    filaSeleccionada.cells[3].textContent = document.getElementById('mant-veh-taller').value;
                    filaSeleccionada.cells[4].textContent = document.getElementById('mant-veh-costo').value;
                    filaSeleccionada.cells[5].textContent = document.getElementById('mant-veh-vehiculo').value;
                } else if(tablaActiva === 'taller'){
                    filaSeleccionada.cells[0].textContent = document.getElementById('taller-id').value;
                    filaSeleccionada.cells[1].textContent = document.getElementById('taller-nombre').value;
                    filaSeleccionada.cells[2].textContent = document.getElementById('taller-descripcion').value;
                    filaSeleccionada.cells[3].textContent = document.getElementById('taller-telefono').value;
                    filaSeleccionada.cells[4].textContent = document.getElementById('taller-correo').value;
                }
                limpiarForm();
            });

            btnEliminar.addEventListener('click', ()=>{
                if(!filaSeleccionada) return alert('Selecciona primero una fila de la tabla activa');
                filaSeleccionada.remove();
                filaSeleccionada = null;
            });

            // al hacer doble click en una fila, rellenar el formulario
            function attachRowDbl(tabla, name){
                tabla.addEventListener('dblclick', function(e){
                    const tr = e.target.closest('tr');
                    if(!tr) return;
                    setActiva(name);
                    filaSeleccionada = tr;
                    if(name === 'vehículos'){
                        document.getElementById('vehiculo-id').value = tr.cells[0].textContent;
                        document.getElementById('vehiculo-mobiliario').value = tr.cells[1].textContent;
                        document.getElementById('vehiculo-tipo').value = tr.cells[2].textContent;
                        document.getElementById('vehiculo-placas').value = tr.cells[3].textContent;
                    } else if(name === 'mantenimiento'){
                        document.getElementById('mant-veh-id').value = tr.cells[0].textContent;
                        document.getElementById('mant-veh-desc').value = tr.cells[1].textContent;
                        document.getElementById('mant-veh-fecha').value = tr.cells[2].textContent;
                        document.getElementById('mant-veh-taller').value = tr.cells[3].textContent;
                        document.getElementById('mant-veh-costo').value = tr.cells[4].textContent;
                        document.getElementById('mant-veh-vehiculo').value = tr.cells[5].textContent;
                    } else if(name === 'taller'){
                        document.getElementById('taller-id').value = tr.cells[0].textContent;
                        document.getElementById('taller-nombre').value = tr.cells[1].textContent;
                        document.getElementById('taller-descripcion').value = tr.cells[2].textContent;
                        document.getElementById('taller-telefono').value = tr.cells[3].textContent;
                        document.getElementById('taller-correo').value = tr.cells[4].textContent;
                    }
                });
            }

            attachRowDbl(tablaVeh, 'vehículos');
            attachRowDbl(tablaMant, 'mantenimiento');
            if(tablaTaller) attachRowDbl(tablaTaller, 'taller');

            // valor inicial
            setActiva('vehículos');
        })();
    </script>

</body>
</html>